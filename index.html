<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> 51Labs :: 새로운 은퇴 준비 서비스 </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        /* 기본 폰트 설정 */
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* 스크롤 애니메이션을 위한 초기 상태 */
        .fade-in-section {
            opacity: 0;
            transform: translateY(23px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* 그라데이션 텍스트 */
        .gradient-text {
            background: linear-gradient(90deg, #15008d, #009dd1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .progress-bar-inner {
            transition: width 0.5s ease-in-out;
        }
        /* Custom slider styles */
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]:focus { outline: none; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 6px; cursor: pointer; background: #d1d5db; border-radius: 9999px; }
        input[type=range]::-webkit-slider-thumb { height: 18px; width: 18px; border-radius: 50%; background: #4f46e5; cursor: pointer; -webkit-appearance: none; margin-top: -6px; }
        input[type=range]::-moz-range-track { width: 100%; height: 6px; cursor: pointer; background: #d1d5db; border-radius: 9999px; }
        input[type=range]::-moz-range-thumb { height: 18px; width: 18px; border-radius: 50%; background: #4f46e5; cursor: pointer; }
    </style>
</head>
    
<body class="bg-gray-50 text-gray-800">

    <!-- Navigation Bar -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-extrabold gradient-text">
                51labs
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Section 1: Hero -->
        <section class="py-20 md:py-32 bg-white">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-3xl md:text-5xl font-black text-gray-900 leading-normal mb-4">
                    <span class="font-black leading-normal">지능화된 설계와 자동화로</span> <br>
                    <span class="gradient-text">사용자를 더 깊이 이해하고</span> <br>
                    <span class="gradient-text leading-normal">맞춤형으로 지원합니다!</span>
                </h1>
                <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                    AI Agent 기반 개인화 서비스와 집단지성을 결합한 새로운 서비스 플랫폼
                </p>
                <div class="flex justify-center gap-4 flex-wrap">
                    <a href="#simulation" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-indigo-700 transition-transform hover:scale-105">
                        AI Simulator Preview
                    </a>
                    <a href="#masterplan" class="bg-gray-200 text-gray-800 font-bold py-3 px-8 rounded-lg text-lg hover:bg-gray-300 transition-transform hover:scale-105">
                        Masterplan
                    </a>
                </div>
            </div>
        </section>
                
       <!-- New Simulation Section -->
        <section id="simulation" class="pt-12 pb-20 md:pt-16 md:pb-28">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-16 fade-in-section">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-4">AI Simulator</h2>
                    <p class="text-lg text-gray-600">컨트롤 패널에서 투자 계획을 설정하면 AI가 당신의 은퇴 계획을 분석합니다.</p>
                </div>
                <div class="bg-white p-4 md:p-8 rounded-2xl shadow-2xl max-w-7xl mx-auto fade-in-section">
                    <!-- New Performance Summary Section -->
                    <div class="mb-8 pb-6 border-b border-gray-200">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">투자 성과 요약</h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <p class="text-2xl mb-1">🎯</p>
                                <p class="font-semibold text-gray-700">은퇴 목표 달성률</p>
                                <p class="text-2xl font-bold text-indigo-600 mt-1">65%</p>
                            </div>
                            <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <p class="text-2xl mb-1">👤</p>
                                <p class="font-semibold text-gray-700">직접 투자</p>
                                <p class="text-2xl font-bold text-gray-800 mt-1">+8.5%</p>
                            </div>
                            <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <p class="text-2xl mb-1">🤖</p>
                                <p class="font-semibold text-gray-700">AI 조언 기반</p>
                                <p class="text-2xl font-bold text-indigo-600 mt-1">+11.2%</p>
                            </div>
                            <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <p class="text-2xl mb-1">📊</p>
                                <p class="font-semibold text-gray-700">우수 성과자 따라하기</p>
                                <p class="text-2xl font-bold text-teal-600 mt-1">+12.8%</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Left Column: Control Panel -->
                        <div class="lg:col-span-1 space-y-6">
                            <div class="bg-slate-100 p-4 rounded-lg">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center"><span class="text-xl mr-2">🤖</span> AI 기반 개인화 서비스</h4>
                                <p class="text-sm text-gray-600 mb-3">당신의 <span class="font-bold">금융 DNA</span>를 설정하면 AI가 맞춤형 조언을 제공합니다.</p>
                                <div id="dna-profile" class="space-y-2 text-sm mb-3">
                                    <div>
                                        <div class="flex justify-between mb-1"><span class="font-medium text-gray-700">안정성</span><span id="dna-stability-val" class="font-bold text-indigo-600">70%</span></div>
                                        <div class="w-full bg-gray-200 rounded-full h-2"><div id="dna-stability-bar" class="bg-indigo-600 h-2 rounded-full progress-bar-inner" style="width: 70%"></div></div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1"><span class="font-medium text-gray-700">성장성</span><span id="dna-growth-val" class="font-bold text-cyan-600">20%</span></div>
                                        <div class="w-full bg-gray-200 rounded-full h-2"><div id="dna-growth-bar" class="bg-cyan-500 h-2 rounded-full progress-bar-inner" style="width: 20%"></div></div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1"><span class="font-medium text-gray-700">현금흐름</span><span id="dna-income-val" class="font-bold text-teal-600">80%</span></div>
                                        <div class="w-full bg-gray-200 rounded-full h-2"><div id="dna-income-bar" class="bg-teal-500 h-2 rounded-full progress-bar-inner" style="width: 80%"></div></div>
                                    </div>
                                </div>
                                <div id="dna-controls" class="grid grid-cols-3 gap-2">
                                    <button data-profile="stable" class="dna-btn bg-indigo-500 text-white p-2 rounded-lg text-xs font-semibold">안정형</button>
                                    <button data-profile="balanced" class="dna-btn bg-white p-2 rounded-lg text-xs font-semibold">균형형</button>
                                    <button data-profile="growth" class="dna-btn bg-white p-2 rounded-lg text-xs font-semibold">성장형</button>
                                </div>
                            </div>
                            <div class="bg-slate-100 p-4 rounded-lg">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center"><span class="text-xl mr-2">🏆</span> 퀘스트 중심 Gamification</h4>
                                <p class="text-sm text-gray-600 mb-3">달성하고 싶은 <span class="font-bold">금융 퀘스트</span>를 선택하여 시뮬레이션에 목표를 부여하세요.</p>
                                <select id="quest-select" class="w-full p-2 border border-gray-300 rounded-lg">
                                    <option value="500000000">5억 자산 만들기</option>
                                    <option value="1000000000" selected>10억 자산 만들기</option>
                                    <option value="2000000000">20억 자산 만들기</option>
                                </select>
                            </div>
                            <div class="bg-slate-100 p-4 rounded-lg">
                                <h4 class="font-bold text-gray-800 mb-2 flex items-center"><span class="text-xl mr-2">📊</span> 실시간 성과 현황 공유</h4>
                                <div class="flex items-center justify-between">
                                    <p class="text-sm text-gray-600"><span class="font-bold">유사 그룹</span> 데이터와 비교</p>
                                    <label for="peer-toggle" class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="peer-toggle" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <!-- Right Column: Simulation Results -->
                        <div class="lg:col-span-2">
                             <div class="bg-slate-100 p-6 rounded-lg h-full flex flex-col">
                                <h3 class="text-xl font-bold text-gray-800 mb-4">시뮬레이션 결과</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                    <div>
                                        <label for="initial-investment" class="text-sm font-semibold text-gray-600">초기 투자금</label>
                                        <p id="initial-investment-value" class="font-bold text-lg text-indigo-600">5,000 만원</p>
                                        <input type="range" id="initial-investment" min="0" max="20000" value="5000" step="1000">
                                    </div>
                                    <div>
                                        <label for="monthly-contribution" class="text-sm font-semibold text-gray-600">월 추가 투자금</label>
                                        <p id="monthly-contribution-value" class="font-bold text-lg text-indigo-600">100 만원</p>
                                        <input type="range" id="monthly-contribution" min="0" max="500" value="100" step="10">
                                    </div>
                                    <div>
                                        <label for="investment-horizon" class="text-sm font-semibold text-gray-600">투자 기간</label>
                                        <p id="investment-horizon-value" class="font-bold text-lg text-indigo-600">20 년</p>
                                        <input type="range" id="investment-horizon" min="5" max="40" value="20" step="1">
                                    </div>
                                </div>
                                <div class="relative h-64 md:h-80 flex-grow">
                                    <canvas id="projectionChart"></canvas>
                                </div>
                                <div id="ai-advice" class="mt-6 bg-indigo-600 text-white p-4 rounded-lg text-sm">
                                    <div class="flex items-start space-x-2">
                                        <span class="text-xl flex-shrink-0">🤖</span>
                                        <div>
                                            <p class="font-bold mb-1">AI 어드바이저:</p>
                                            <p id="advice-text"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- New Follow High Performers Section -->
                    <div class="mt-8 pt-6 border-t border-gray-200">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">우수 성과자 따라하기</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <span class="text-4xl">👨‍🚀</span>
                                <p class="font-bold mt-2">투자마스터J</p>
                                <p class="text-sm text-green-600 font-semibold">연평균 12%</p>
                                <p class="text-xs text-gray-500">목표 달성률 95%</p>
                                <div class="mt-3 flex gap-2">
                                    <button class="w-full text-xs bg-indigo-500 text-white py-1.5 rounded-md hover:bg-indigo-600">Follow</button>
                                    <button class="w-full text-xs bg-white border border-gray-300 py-1.5 rounded-md hover:bg-gray-200">Connect</button>
                                </div>
                            </div>
                             <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <span class="text-4xl">👩‍🔬</span>
                                <p class="font-bold mt-2">안정추구K</p>
                                <p class="text-sm text-green-600 font-semibold">연평균 8%</p>
                                <p class="text-xs text-gray-500">목표 달성률 98%</p>
                                <div class="mt-3 flex gap-2">
                                    <button class="w-full text-xs bg-indigo-500 text-white py-1.5 rounded-md hover:bg-indigo-600">Follow</button>
                                    <button class="w-full text-xs bg-white border border-gray-300 py-1.5 rounded-md hover:bg-gray-200">Connect</button>
                                </div>
                            </div>
                             <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <span class="text-4xl">👨‍💻</span>
                                <p class="font-bold mt-2">테크성장L</p>
                                <p class="text-sm text-green-600 font-semibold">연평균 15%</p>
                                <p class="text-xs text-gray-500">목표 달성률 85%</p>
                                <div class="mt-3 flex gap-2">
                                    <button class="w-full text-xs bg-indigo-500 text-white py-1.5 rounded-md hover:bg-indigo-600">Follow</button>
                                    <button class="w-full text-xs bg-white border border-gray-300 py-1.5 rounded-md hover:bg-gray-200">Connect</button>
                                </div>
                            </div>
                             <div class="bg-slate-100 p-4 rounded-lg text-center">
                                <span class="text-4xl">👩‍🎨</span>
                                <p class="font-bold mt-2">배당여왕P</p>
                                <p class="text-sm text-green-600 font-semibold">연평균 9%</p>
                                <p class="text-xs text-gray-500">목표 달성률 99%</p>
                                <div class="mt-3 flex gap-2">
                                    <button class="w-full text-xs bg-indigo-500 text-white py-1.5 rounded-md hover:bg-indigo-600">Follow</button>
                                    <button class="w-full text-xs bg-white border border-gray-300 py-1.5 rounded-md hover:bg-gray-200">Connect</button>
                                </div>
                            </div>
                        </div>
                    </div>
                     <!-- New Lifecycle Section -->
                    <div class="mt-8 pt-6 border-t border-gray-200">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 text-center">생애주기별 포트폴리오 예시</h3>
                        <div class="bg-slate-100 p-6 rounded-lg">
                            <div id="lifecycle-tabs" class="flex flex-wrap justify-center border-b border-gray-300 mb-4">
                                <button data-stage="stage1" class="lifecycle-tab px-4 py-2 text-sm font-semibold bg-indigo-600 text-white border-b-2 border-indigo-600">20-40대: 자산 형성기</button>
                                <button data-stage="stage2" class="lifecycle-tab px-4 py-2 text-sm font-semibold text-gray-500">50대: 은퇴 준비기</button>
                                <button data-stage="stage3" class="lifecycle-tab px-4 py-2 text-sm font-semibold text-gray-500">55세+: 연금 수령기</button>
                                <button data-stage="stage4" class="lifecycle-tab px-4 py-2 text-sm font-semibold text-gray-500">65세+: 자산 인출기</button>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                                <div class="md:col-span-1 h-48 w-48 mx-auto relative">
                                    <canvas id="lifecycleChart"></canvas>
                                </div>
                                <div class="md:col-span-2">
                                    <h4 id="lifecycle-title" class="font-bold text-lg text-gray-800">자산 형성기</h4>
                                    <div id="lifecycle-description" class="text-sm text-gray-600 mt-2 space-y-1"></div>
                                </div>
                            </div>
                            <div id="lifecycle-legend" class="flex flex-wrap justify-center gap-x-4 gap-y-1 mt-4"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: The Roadmap -->
        <section id="masterplan" class="py-20 md:py-28 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16 fade-in-section">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-4">플랫폼 구현 Masterplan</h2>
                    <p class="text-lg text-gray-600">초기 단계 계획이며 추후 상세화됩니다.</p>
                </div>
                <div class="relative max-w-2xl mx-auto">
                    <!-- The vertical line -->
                    <div class="absolute left-1/2 -ml-px w-0.5 h-full bg-indigo-200" aria-hidden="true"></div>
                    <!-- Roadmap Items -->
                    <div class="space-y-16">
                        <!-- Item 1 -->
                        <div class="relative flex items-center fade-in-section">
                            <div class="w-1/2 pr-8 text-right">
                                <p class="text-indigo-600 font-bold">Phase 1</p>
                                <h3 class="text-2xl font-bold text-gray-900 mt-1">Service Architecture 설계 및 MVP 개발</h3>
                                <p class="text-gray-600 mt-2"></p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-indigo-600 text-white flex items-center justify-center absolute left-1/2 -translate-x-1/2 ring-8 ring-white">1</div>
                        </div>
                        <!-- Item 2 -->
                        <div class="relative flex items-center fade-in-section">
                            <div class="w-1/2"></div>
                            <div class="w-1/2 pl-8 text-left">
                                <p class="text-indigo-600 font-bold">Phase 2</p>
                                <h3 class="text-2xl font-bold text-gray-900 mt-1">핵심 기능 프레임워크 구현</h3>
                                <p class="text-gray-600 mt-2">AI 기반 컨설팅, 사용자 Clustering, 실시간 투자 평가, Gamification 등 프레임워크 구현</p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-indigo-600 text-white flex items-center justify-center absolute left-1/2 -translate-x-1/2 ring-8 ring-white">2</div>
                        </div>
                        <!-- Item 3 -->
                        <div class="relative flex items-center fade-in-section">
                            <div class="w-1/2 pr-8 text-right">
                                <p class="text-indigo-600 font-bold">Phase 3</p>
                                <h3 class="text-2xl font-bold text-gray-900 mt-1">베타 테스트 및 론칭 준비</h3>
                                <p class="text-gray-600 mt-2">Closed/Open Beta Test 및 사업화 추진</p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-indigo-600 text-white flex items-center justify-center absolute left-1/2 -translate-x-1/2 ring-8 ring-white">3</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Join the Pioneers -->
        <section id="join" class="py-20 md:py-28 bg-indigo-700 text-white">
            <div class="container mx-auto px-6 text-center">
                <div class="max-w-3xl mx-auto fade-in-section">
                    <h2 class="text-3xl md:text-4xl font-extrabold mb-4">새로운 소식을 가장 빨리 공유하겠습니다.</h2>
                    <p class="text-lg text-indigo-200 mb-8">                        
                    </p>
                    <div class="bg-white/10 p-8 rounded-2xl text-left space-y-4 mb-8">
                        <div class="flex items-start gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-green-400 flex-shrink-0 mt-1">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <p><span class="font-bold">개발 소식 알림: </span>구체화된 개발 일정과 성과에 대해 공유합니다.</p>
                        </div>
                        <div class="flex items-start gap-3">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-green-400 flex-shrink-0 mt-1">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <p><span class="font-bold">서비스 미리 경험: </span>핵심 서비스 Early Access 및 Value Pack 체험 기회를 드립니다.</p>
                        </div>
                        <div class="flex items-start gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-green-400 flex-shrink-0 mt-1">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <p><span class="font-bold">다양한 행사 초대: </span>은퇴 설계 및 실행 관련 실제 사례를 공유합니다.</p>
                        </div>
                    </div>
                    <form id="pioneer-form" class="max-w-lg mx-auto">
                        <div class="flex flex-col sm:flex-row gap-4">
                            <input type="email" name="email" placeholder="등록 기능은 준비 중입니다." class="w-full px-5 py-3 rounded-lg text-gray-500 bg-gray-200 cursor-not-allowed focus:outline-none" disabled>
                            <button type="submit" id="submit-button" class="bg-gray-400 text-white font-bold py-3 px-8 rounded-lg cursor-not-allowed flex-shrink-0">
                                추후 오픈 예정
                            </button>
                        </div>
                        <p id="form-message" class="mt-4 h-6"></p>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>서울 서초구 사임당길8로 13, 4층</p>
            <p>&copy; 2025 51labs LLC. / 오일랩스 유한회사 All Rights Reserved.</p>
            <br><br><br>
        </div>
    </footer>

    <script>
        // 스크롤 애니메이션
        const sections = document.querySelectorAll('.fade-in-section');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                }
            });
        }, { threshold: 0.1 });
        sections.forEach(section => { observer.observe(section); });

        // 이메일 등록 폼 비활성화
        const form = document.getElementById('pioneer-form');
        const submitButton = document.getElementById('submit-button');
        submitButton.disabled = true;
        form.addEventListener('submit', (e) => {
            e.preventDefault();
        });

        // --- 통합 시뮬레이터 로직 ---
        const dnaControls = document.getElementById('dna-controls');
        const dnaButtons = dnaControls.querySelectorAll('.dna-btn');
        const adviceText = document.getElementById('advice-text');
        
        const initialInvestmentSlider = document.getElementById('initial-investment');
        const monthlyContributionSlider = document.getElementById('monthly-contribution');
        const investmentHorizonSlider = document.getElementById('investment-horizon');
        const questSelect = document.getElementById('quest-select');
        const peerToggle = document.getElementById('peer-toggle');
        
        const initialValueEl = document.getElementById('initial-investment-value');
        const monthlyValueEl = document.getElementById('monthly-contribution-value');
        const horizonValueEl = document.getElementById('investment-horizon-value');

        const projectionCtx = document.getElementById('projectionChart').getContext('2d');
        let projectionChart;

        const dnaProfiles = {
            stable: { stability: 70, growth: 20, income: 80, rates: { optimistic: 0.08, average: 0.05, pessimistic: 0.03 } },
            balanced: { stability: 50, growth: 50, income: 60, rates: { optimistic: 0.10, average: 0.07, pessimistic: 0.04 } },
            growth: { stability: 20, growth: 80, income: 30, rates: { optimistic: 0.13, average: 0.09, pessimistic: 0.05 } }
        };
        let currentDnaProfile = 'stable';

        function formatCurrency(value) {
            if (value >= 100000000) return `${(value / 100000000).toFixed(1)} 억원`;
            return `${(value / 10000).toLocaleString()} 만원`;
        }

        function updateSimulation() {
            const P = parseFloat(initialInvestmentSlider.value) * 10000;
            const M = parseFloat(monthlyContributionSlider.value) * 10000;
            const T = parseInt(investmentHorizonSlider.value);
            const questTarget = parseFloat(questSelect.value);
            const showPeers = peerToggle.checked;

            initialValueEl.textContent = formatCurrency(P);
            monthlyValueEl.textContent = formatCurrency(M);
            horizonValueEl.textContent = `${T} 년`;

            const userRates = dnaProfiles[currentDnaProfile].rates;
            const peerRates = dnaProfiles['balanced'].rates; // Peer group is always 'balanced' for comparison

            const results = { user: [], peer_avg: [], peer_top: [] };
            const labels = [];
            
            for (let year = 0; year <= T; year++) {
                labels.push(new Date().getFullYear() + year);
                
                let r_user = userRates.average / 12;
                let n = year * 12;
                let userValue = P * Math.pow(1 + r_user, n) + (r_user > 0 ? M * ((Math.pow(1 + r_user, n) - 1) / r_user) : M * n);
                results.user.push(userValue);

                if (showPeers) {
                    let r_peer_avg = peerRates.average / 12;
                    let peerAvgValue = P * Math.pow(1 + r_peer_avg, n) + (r_peer_avg > 0 ? M * ((Math.pow(1 + r_peer_avg, n) - 1) / r_peer_avg) : M * n);
                    results.peer_avg.push(peerAvgValue);
                    
                    let r_peer_top = peerRates.optimistic / 12;
                    let peerTopValue = P * Math.pow(1 + r_peer_top, n) + (r_peer_top > 0 ? M * ((Math.pow(1 + r_peer_top, n) - 1) / r_peer_top) : M * n);
                    results.peer_top.push(peerTopValue);
                }
            }
            
            updateProjectionChart(labels, results, showPeers);
            updateAdvice(results.user[T], questTarget, T);
        }

        function updateProjectionChart(labels, results, showPeers) {
            if (projectionChart) {
                projectionChart.destroy();
            }
            
            const datasets = [{
                label: '나의 예상 자산',
                data: results.user,
                borderColor: '#4f46e5',
                backgroundColor: 'rgba(79, 70, 229, 0.2)',
                fill: true,
                tension: 0.3,
                pointRadius: 0,
            }];

            if (showPeers) {
                datasets.push({
                    label: '유사 그룹 평균',
                    data: results.peer_avg,
                    borderColor: 'rgba(107, 114, 128, 0.5)',
                    borderDash: [5, 5],
                    fill: false,
                    tension: 0.3,
                    pointRadius: 0,
                });
                datasets.push({
                    label: '상위 10% 그룹',
                    data: results.peer_top,
                    borderColor: 'rgba(251, 191, 36, 0.5)',
                    borderDash: [5, 5],
                    fill: false,
                    tension: 0.3,
                    pointRadius: 0,
                });
            }

            projectionChart = new Chart(projectionCtx, {
                type: 'line',
                data: { labels, datasets },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { ticks: { callback: (v) => formatCurrency(v) } }, x: { ticks: { maxRotation: 0, minRotation: 0 } } },
                    plugins: { legend: { display: true, position: 'bottom' }, tooltip: { mode: 'index', intersect: false, callbacks: {
                        label: (ctx) => `${ctx.dataset.label}: ${formatCurrency(ctx.parsed.y)}`
                    }}},
                    interaction: { mode: 'index', intersect: false }
                }
            });
        }
        
        function updateAdvice(finalValue, questTarget, years) {
            let advice = "";
            if (finalValue >= questTarget) {
                advice = `축하합니다! 현재 계획대로라면 ${years}년 후 <span class="font-bold">${formatCurrency(questTarget)} 퀘스트</span> 달성이 가능합니다. 최종 자산은 약 <span class="font-bold">${formatCurrency(finalValue)}</span>으로 예상됩니다.`;
            } else {
                const shortfall = questTarget - finalValue;
                advice = `현재 계획으로는 ${years}년 후 <span class="font-bold">${formatCurrency(questTarget)} 퀘스트</span> 달성이 어렵습니다. 약 <span class="font-bold">${formatCurrency(shortfall)}</span>이 부족합니다. 월 투자금을 늘리거나 투자 기간을 조정해보세요.`;
            }
            adviceText.innerHTML = advice;
        }

        dnaControls.addEventListener('click', (e) => {
            if (e.target.classList.contains('dna-btn')) {
                currentDnaProfile = e.target.dataset.profile;
                const { stability, growth, income } = dnaProfiles[currentDnaProfile];
                
                document.getElementById('dna-stability-bar').style.width = `${stability}%`;
                document.getElementById('dna-stability-val').textContent = `${stability}%`;
                document.getElementById('dna-growth-bar').style.width = `${growth}%`;
                document.getElementById('dna-growth-val').textContent = `${growth}%`;
                document.getElementById('dna-income-bar').style.width = `${income}%`;
                document.getElementById('dna-income-val').textContent = `${income}%`;
                
                dnaButtons.forEach(btn => btn.classList.replace('bg-indigo-500', 'bg-white') || btn.classList.replace('text-white', 'text-gray-800'));
                e.target.classList.replace('bg-white', 'bg-indigo-500');
                e.target.classList.replace('text-gray-800', 'text-white');
                
                updateSimulation();
            }
        });

        [initialInvestmentSlider, monthlyContributionSlider, investmentHorizonSlider, questSelect, peerToggle].forEach(el => {
            el.addEventListener('input', updateSimulation);
        });

        updateSimulation();

        // Lifecycle pie charts
        const lifecycleTabs = document.getElementById('lifecycle-tabs');
        const lifecycleTitle = document.getElementById('lifecycle-title');
        const lifecycleDescription = document.getElementById('lifecycle-description');
        const lifecycleCtx = document.getElementById('lifecycleChart').getContext('2d');
        const lifecycleLegend = document.getElementById('lifecycle-legend');
        let lifecycleChart;

        const lifecycleData = {
            stage1: { 
                title: '20-40대: 자산 형성기', 
                description: [
                    '#장기투자 #복리효과 #공격적자산배분',
                    '긴 투자 기간을 활용하여 자산 증식에 집중하는 시기입니다.',
                    '위험 감수도를 높여 성장주, 기술주 ETF 등의 비중을 높게 가져갑니다.',
                    '연금저축, IRP 등 절세 계좌를 최대한 활용하여 세금 혜택을 통한 복리 효과를 극대화하는 것이 중요합니다.'
                ], 
                data: [60, 15, 5, 20], 
                labels: ['성장주식', '안정채권', '현금', '절세계좌'] 
            },
            stage2: { 
                title: '50대: 은퇴 준비기', 
                description: [
                    '#자산보존 #포트폴리오안정화 #배당주',
                    '자산 증식과 안정성의 균형을 맞춰야 합니다.',
                    '위험자산 비중을 점진적으로 축소하고 배당주, 우량채권 비중을 늘려 포트폴리오를 안정화합니다.',
                    '은퇴 후 현금흐름을 예측하고, 연금 수령 계획을 구체화하기 시작해야 합니다.'
                ], 
                data: [40, 30, 10, 20], 
                labels: ['배당주', '우량채권', '현금', '절세계좌'] 
            },
            stage3: { 
                title: '55세+: 연금 수령기', 
                description: [
                    '#현금흐름 #자산인출전략 #저변동성',
                    '안정적인 현금흐름 확보가 최우선 목표입니다.',
                    '채권 및 고배당주 비중을 늘려 원금 손실 위험을 최소화하고 자산을 보존하는 데 집중합니다.',
                    '사적연금 수령을 시작하며, 세금 부담을 최소화하는 효율적인 인출 전략이 필요합니다.'
                ], 
                data: [25, 40, 15, 20], 
                labels: ['고배당주', '국공채', '현금', '절세계좌'] 
            },
            stage4: { 
                title: '65세+: 자산 인출기', 
                description: [
                    '#자산보존 #유동성확보 #상속계획',
                    '자산 보존을 최우선으로 합니다.',
                    '현금 및 단기채권 등 안전자산 비중을 높여 시장 변동성의 영향을 최소화하는 전략이 필요합니다.',
                    '국민연금(노령연금) 수령과 함께, 건강보험료 등을 고려한 종합적인 자산 인출 계획을 세워야 합니다.'
                ], 
                data: [10, 35, 30, 25], 
                labels: ['배당주', '단기채권', '현금', '절세계좌'] 
            }
        };

        function updateLifecycleView(stage) {
            const stageData = lifecycleData[stage];
            lifecycleTitle.textContent = stageData.title;
            lifecycleDescription.innerHTML = stageData.description.map(line => `<p>${line}</p>`).join('');

            const chartColors = ['#4f46e5', '#3b82f6', '#60a5fa', '#14b8a6'];

            if (lifecycleChart) {
                lifecycleChart.data.labels = stageData.labels;
                lifecycleChart.data.datasets[0].data = stageData.data;
                lifecycleChart.data.datasets[0].backgroundColor = chartColors;
                lifecycleChart.update();
            } else {
                 lifecycleChart = new Chart(lifecycleCtx, {
                    type: 'pie',
                    data: {
                        labels: stageData.labels,
                        datasets: [{
                            data: stageData.data,
                            backgroundColor: chartColors,
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }

            lifecycleLegend.innerHTML = stageData.labels.map((label, index) => `
                <div class="flex items-center">
                    <span class="w-3 h-3 rounded-full mr-2" style="background-color: ${chartColors[index]}"></span>
                    <span class="text-xs text-gray-600">${label}</span>
                </div>
            `).join('');
        }

        lifecycleTabs.addEventListener('click', (e) => {
            if(e.target.tagName === 'BUTTON') {
                const stage = e.target.dataset.stage;
                document.querySelectorAll('.lifecycle-tab').forEach(tab => {
                    tab.classList.remove('bg-indigo-600', 'text-white', 'border-indigo-600');
                    tab.classList.add('text-gray-500');
                });
                e.target.classList.add('bg-indigo-600', 'text-white', 'border-indigo-600');
                e.target.classList.remove('text-gray-500');
                updateLifecycleView(stage);
            }
        });

        updateLifecycleView('stage1');

    </script>


</body>
</html>
